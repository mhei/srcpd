.TH srcpd.conf 5 "28. Dezember 2007"
.\"
.\"
.SH "NAME"
srcpd.conf \- Die Konfigurationsdatei für den srcpd Deamon
.\"
.\"
.SH "BESCHREIBUNG"
Die Datei \fIsrcpd.conf\fP wird vom SRCP-Daemon \fBsrcpd\fP als
systemweite Konfigurationsdatei genutzt. Sie bescheibt die
für die Laufzeit des Systemsdienstes entscheidenden Einstellungen zum
Verhalten des Daemons selbst, sowie die Anzahl, Art und Betriebsweise
der angeschlossenen Schnittstellen zur Modellbahn. Weitere Details zum
Betrieb beschreibt das Handbuch
.BR srcpd (8)
des Daemons.
.\"
.\"
.SH "STANDARD KONFIGURATIONSDATEI"
.\"
.PP
Die dem \fBsrcpd\fP mitgelieferte Standardkonfigurationsdatei enthält
beispielhafte Einstellungen sowohl für den Server als auch für einen
vorkonfigurierten Bus. Sie hat den folgenden Aufbau:
.PP
.RS
.nf
<?xml version="1.0"?>
<srcpd version="2.0">
  <bus>
    <server>
      <tcp-port>4303</tcp-port>
      <pid-file>/var/run/srcpd.pid</pid-file>
      <username>nobody</username>
      <groupname>nogroup</groupname>
    </server>
    <verbosity>5</verbosity>
  </bus>
  <bus>
    <loopback>
      <number_fb>3</number_fb>
    </loopback>
    <use_watchdog>no</use_watchdog>
    <verbosity>5</verbosity>
    <auto_power_on>yes</auto_power_on>
  </bus>
</srcpd>
.fi
.RE
.\"
.\"
.SH "DATEIFORMAT"
.\"
.PP
Die Konfigurationsdatei wird im XML-Format abgespeichert. Da es sich bei
XML-Dateien um ein reines Textformat handelt, kann ein erfahrener
Benutzer solche Dateien mit einem beliebigen Texteditor bearbeiten.
Weniger erfahrenen Benutzern sei empfohlen, Veränderungen in der Datei
mit einem speziellen Programm vorzunehmen, damit der Inhalt der Datei
stets korrektes XML enthält.
.PP
Treten beim Lesen der Konfigurationsdatei Fehler auf, sendet \fBsrcpd\fP
entsprechende Fehlermeldungen an den syslog-Daemon. Diese können über
die Datei \fI/var/log/messages\fP verfolgt werden.
.\"
.PP
Aktuell gibt es keine Dokumententypspezifikation (DTD), mit der der
Inhalt der Konfigurationsdatei auf seine Gültigkeit hin überprüft werden
kann.
.\"
.PP
Jede Konfigurationsdatei muß die folgende Grundstruktur enthalten:
.\"
.PP
.nf
    <?xml version="1.0"?>
    <srcpd>
    ...
    </srcpd>
.fi

.PP
Innerhalb dieser Struktur (...) werden die verwendeten Busse angelegt,
für die es jeweils wieder eine eigene Grundstruktur gibt:
.PP
.nf
    <bus>
    ...
    </bus>
    <bus>
    ...
    </bus>
.fi
.\"
.\"
.SS Allgemeine Hinweise
.PP
Der erste konfigurierte Bus muss der für den Server selbst sein. Die
Reihenfolge und die Anzahl der weiteren Busse sind beliebig. Es sollten
nur Busse konfiguriert werden, die auch tatsächlich beim Betrieb des
Daemons Verwendung finden. Nicht benötigte Busse können beispielsweise
über Kommentarzeichen ausgeklammert werden:
.PP
.nf
    <!--
    <bus>
    ...
    </bus>
    -->
.fi

.PP
Hierbei ist zu beachten, das die Nummern der nachfolgenden Busse
sich entsprechend verschieben.
.\"
.\"
.SS Allgemeingültige Optionen
.PP
Die folgenden Konfigurationsoptionen lassen sich für alle Busse
jeweils individuell festlegen.
.\"
.TP
verbosity
Abhängig von diesem Zahlenwert (0..7) erzeugt \fBsrcpd\fP während des
Betriebs mehr oder weniger ausführliche Protokollmeldungen zum aktuellen
Geschehen. Mit dem Wert 0 erfolgt nur eine minimale Ausgabe, mit höheren
Werten steigt auch die Ausführlichkeit dieser Meldetätigkeit. Für die
Fehlersuche sollte der Wert möglichst hoch, bei störungsfreiem Betrieb
möglichst niedrig gewählt werden. Die Meldungen lassen sich über die
Log-Datei des Syslog-Daemons \fI/var/log/messages\fP verfolgen; nähere
Informationen hierzu befinden sich im Handbuch \fBsrcpd (8)\fP.
.\"
.TP
device
Hiermit wird der Name der angesteuerten Schnittstelle (z.B. /dev/ttyS0)
festgelegt. Die Busse \fBserver\fP und \fBloopback\fP benötigen diesen
Eintrag nicht.
.\"
.TP
auto_power_on
Hiermit wird festgelegt, ob beim Start des Daemons automatisch der
Digitalstrom des Busses eingeschaltet wird. Gültige Werte sind »yes«
oder »no«. Die Busse \fBserver\fP und \fBloopback\fP benötigen diesen
Eintrag nicht. Der voreingestellte Wert ist »no«.
.\"
.\"
.SS server
.\"
.PP
Dieser Bus darf in keiner Konfigurationsdatei fehlen. Er verfügt über
die folgenden Einstellmöglichkeiten:
.\"
.TP
tcp-port
Mit diesem Wert wird die Netzwerkportnummer für die TCP/IP-Kommunikation
zwischen \fBsrcpd\fP und den SRCP-Clients festgelegt. Die Voreinstellung
hierfür ist der von der IANA festgelegte Wert \fB4303\fP.
.\"
.TP
pid-file
Name der Datei, in der \fBsrcpd\fP die Prozess-ID abspeichert. Der
voreingestellte Wert hierfür ist \fI/var/run/srcpd.pid\fP.
.\"
.TP
username
Benutzerkennung, unter der \fBsrcpd\fP auf dem System läuft.
Voreingestellt ist \fBnobody\fP.
.\"
.TP
groupname
Gruppenkennung unter der \fBsrcpd\fP auf dem System läuft. Voreingestellt
ist \fBnogroup\fP.
.\"
.\"
.SS ddl
.PP
Digital Direct für Linux über die serielle Schnittstelle (RS232).
.TP
number_ga
.TP
number_gl
.TP
enable_ringindicator_checking
.TP
enable_checkshort_checking
.TP
inverse_dsr_handling
.TP
enable_maerklin
.TP
enable_nmradcc
.TP
improve_nmradcc_timing
.TP
shortcut_failure_delay
.TP
nmradcc_translation_routine
.TP
enable_usleep_patch
.TP
usleep_usec
.\"
.\"
.SS ddl-s88
.PP
Digital Direct für Linux S88 über die parallele Schnittstelle (IEEE 1284).
.TP
ioport
Eingabe/Ausgabe-Adresse des Druckeranschlusses. Der voreingestellte Wert
ist 0x0378.
.TP
clockscale
.TP
refresh
.TP
p_time
.TP
number_fb_1
.TP
number_fb_2
.TP
number_fb_3
.TP
number_fb_4
.\"
.\"
.SS hsi-88
.\"
.PP
Dieses Modul unterstützt den Betrieb eines Littfinski HSI-88, das an
eine serielle Schnittstelle angeschlossen ist. Auch der Anschluß über
einen USB/Seriell-Konvertierer sollte problemlos möglich sein. Die
Geschwindigkeitseinstellung für die serielle Schnittstelle ist fest auf
9600 Baud eingestellt und kann nicht verändert werden.

Das HSI-88 verfügt über drei Kanäle zum Anschluß von
S88-Rückmeldemodulen. Die Summe der pro Kanal angeschlossenen Module
(mit 16 Kontakten) darf maximal 31 betragen, sonst erfolgt die Ausgabe
einer Fehlermeldung. Bei der Verwendung von Modulen mit 8 Kontakten
zählen 2 Module wie eines mit 16 Kontakten.
.\"
.TP
number_fb_left
Diese Angabe legt die Anzahl der am Kanal mit der Bezeichnung
\fBlinks\fP angeschlossenen Rückmeldemodule fest.
.\"
.TP
number_fb_center
Diese Angabe legt die Anzahl der am Kanal mit der Bezeichnung
\fBmitte\fP angeschlossenen Rückmeldemodule fest.
.\"
.TP
number_fb_right
Diese Angabe legt die Anzahl der am Kanal mit der Bezeichnung
\fBrechts\fP angeschlossenen Rückmeldemodule fest.
.\"
.TP
fb_delay_time_0
Dieser Wert in Millisekunden legt fest, wie lange ein Rückmeldekontakt
auf Null liegen muß, bevor er als gültiger Wert weitergeleitet wird.
Hiermit lassen sich schlechte Rückmeldungen (Wackler) in begrenztem
Umfang entprellen. Der voreingestellte Wert beträgt 0 ms.
.\"
.TP
refresh
Wartezeit in Mikrosekungen nach der die Rückmeldungen des Geräts erneut
eingelesen werden. Der voreingestellte Wert beträgt 10000 µs.
.\"
.\"
.SS i2c-dev
.PP
Bustreiber für das i2c-dev-Interface des Linux Kernels. Er kann
beispielsweise mit der unter http://www.matronix.de/ zu findenden
Hardware genutzt werden.
.TP
multiplex_buses
.TP
ga_hardware_inverters
.TP
ga_reset_device
.\"
.\"
.SS intellibox
.\"
.PP
Dieses Modul unterstüzt den Betrieb mit einer Uhlenbrock Intellibox (IB),
die über eine serielle Schnittstelle angeschlossen ist. Die Ansteuerung
der IB erfolgt über das P50X-Protokoll, zum geringeren Teil mit der
analogen und zum größeren Teil mit der binären Variante. Beim Betrieb mit
protokollkompatiblen Zentralen anderer Hersteller ist das gegebenenfalls
zu berücksichtigen. Das Programmieren von Decodern ist zur Zeit nur
für DCC implementiert. Als Schnittstellengeschwindigkeit sind die
folgenden Varianten möglich: 2400 Baud, 4800 Baud, 9600 Baud, 19200
Baud und 38400 Baud.
.\"
.TP
fb_delay_time_0
Dieser Wert in Millisekunden legt fest, wie lange ein Rückmeldekontakt
auf Null liegen muß, bevor er als gültiger Wert weitergeleitet wird.
Hiermit lassen sich schlechte Rückmeldungen (Wackler) in begrenztem
Umfang entprellen. Der voreingestellte Wert beträgt 0 ms.
.\"
.TP
pause_between_commands
Mit diesem Wert wird die Verzögerungszeit in Millisekungen eingestellt,
nach der ein weiterer Befehl an die angeschlossenen Zentrale gesendet
wird. Der optimale Wert muß händisch ermittelt werden. Wenn die Zentrale
nicht reagiert, oder Befehlte ignoriert, sollte der Wert erhöht werden.
Der voreingestellte Wert beträgt 250 ms.
.\"
.TP
number_ga
Dieser Wert legt den maximalen Adressbereich für die verwendeten
Magnetartikel (GA) fest. Gültig sind Werte von 0 bis 1024. Ein Wert von 0
bedeutet, dass keine Magnetartikel verwendet werden. Der voreingestellte
Wert beträgt 256.
.\"
.TP
number_gl
Dieser Wert legt den maximalen Adressbereich für die verwendeten
Lokdecoder (GL) fest. Gültig sind Werte von 0 bis 10239. Ein Wert von 0 
bedeutet, dass keine Lokdecoder verwendet werden. Der voreingestellte 
Wert beträgt 80.
.\"
.TP
number_fb
Dieser Wert legt die Anzahl der an der IB angeschlossenen
S88-Rückmeldemodule fest. Gültig sind Werte von 0 bis 31 (bei Modulen
mit 16 Kontakten). Der voreingestellte Wert beträgt 0 (keine Module sind
angeschlossen. Über Loconet angeschlossene Module werden gegenwärtig
nicht unterstützt.
.\"
.\"
.SS li100, li100usb
.\"
.PP
Dieses Modul unterstützt den Betrieb mit den Lenz-Geräten LI100, LI100F,
LI101F und LI-USB, angeschlossen über die serielle Schnittstelle (RS232)
oder den Universal Serial Bus (USB). Ein USB/Seriell-Konvertierer sollte
nicht verwendet werde. Die möglichen Geschwindigkeiten der seriellen
Schnittstelle sind vom verwendeten Gerät abhängig. Für das LI-USB ist
sie fest auf 57600 Baud eingestellt, ohne Möglichkeit, das zu verändern.
Ein automatisches Erkennen der richtigen Geschwindikeit ist derzeit in
Arbeit. Wenn die Verbindungsaufnahme scheitert, versuchen Sie mit einer
anderen Geschwindigkeitseinstellung zurecht zu kommen. Erlaubte Werte
sind, abhängig vom verwendeten Gerät, 9600 Baud, 19200 Baud, 38400 Baud,
57600 Baud und 115200 Baud.
.\"
.TP
fb_delay_time_0
Dieser Wert in Millisekunden legt fest, wie lange ein Rückmeldekontakt
auf Null liegen muß, bevor er als gültiger Wert weitergeleitet wird.
Hiermit lassen sich schlechte Rückmeldungen (Wackler) in begrenztem
Umfang entprellen. Der voreingestellte Wert beträgt 0 ms.
.\"
.TP
number_ga
Dieser Wert legt den maximalen Adressbereich für die verwendeten
Magnetartikel (GA) fest. Gültig sind Werte von 0 bis 1024. Ein Wert von 0
bedeutet, dass keine Magnetartikel verwendet werden. Der voreingestellte
Wert beträgt 99, beim LI-USB 9999.
.\"
.TP
number_gl
Like the number of GA this number gives the maximum address. Supported range
is 0..9999. A value of 0 means no GL available.
Default is 99 (LI-USB 9999).
.\"
.TP
number_fb
Dieser Wert legt die Anzahl der angeschlossenen RS-Module fest. Gültig
sind Werte von 0 bis 512 (bei Modulen mit 8 Kontakten); 0 bedeutet, keine
Module sind angeschlossen. Der voreingestellte Wert beträgt 256, beim
LI-USB 512.
.\"
.\"
.SS loopback
.\"
.PP
Dieser Bus stellt keine Verbindung zu einem existierenden Steuergerät
her. Er ist primär für Entwicklungzwecke gedacht kann aber auch 
bei betriebsfähgien Installationen nützlich sein. Jedes Kommando auf
diesem Bus bewirkt lediglich ein entsprechendes Echo bei den
INFO-Sitzungen. Dieser Bus kann also auch für Kommunikationszwecke
genutzt werden.
.\"
.TP
number_ga
Anzahl der adressierbaren Magnetartikel (GA). Die Voreinstellung ist 256.
.\"
.TP
number_gl
Anzahl der adressierbaren Lokdecoder (GL). Die Voreinstellung ist 80.
.\"
.TP
number_fb
Anzahl der adressierbaren Rückmeldemodule mit je 16 Kontakten. Die
Voreinstellung ist 0 (keine Rückmeldemodule vorhanden).
.\"
.\"
.SS m605x
.\"
.PP
This driver connects with the 6051 or 6050 devices from Marklin connected
via the serial port. An USB2Serial converter should work fine. The serial
line settings are fixed to 2400 8N2 and cannot be changed.
.\"
.TP
m6020mode
In this mode the srcpd does not sent the 4 functions. This
is a feature of the 6021 only.
.\"
.TP
p_time
This is the time the driver code waits until it recognized the input
change in milliseconds. This feature may support a debounce found in
the hardware.
.\"
.TP
ga_min_activetime
The time in milliseconds a GA device needs to be in active state. The
absolute minimum is 75 ms and is needed for stable communication with
the 6051.
.\"
.TP
pause_between_commands
This is the time between two commands the drivers must wait. The exact
values should be hand tuned. If the system does not respond or drops
commands try to increase this value. Default is 200 (milliseconds).
.\"
.TP
pause_between_bytes
This is the time the driver waits between 2 bytes in multi-byte commands.
The hardware handshake does not work with all devices so this parameter
was introduced to support it. The default is 2 (milliseconds)
.\"
.TP
number_ga
This is the number of GA. This parameter does not have a real effect
since the interface supports the addresses 1...256 only. Keep the
default untouched.
.\"
.TP
number_gl
Like the number of GA this number gives the maximum address. Since this
number is limited to 80, keep the default untouched.
.\"
.TP
number_fb
This is the number of 6088 modules attached to the 6051/6050 device.
It can be as large as 31. The default is 0 (no modules are attached).
Please note that 6088 modules attached to other devices (memory)
cannot be accessed.
.\"
.\"
.SS selectrix
.PP
Selectrix CC-2000 und Rautenhaus SLX852.
.TP
number_ga
.TP
number_gl
.TP
number_fb
.TP
controller
.\"
.\"
.SS zimo
.PP
Zimo MX1
.TP
number_ga
.TP
number_gl
.TP
number_fb
.TP
p_time
.\"
.\"
.SH "DATEIEN"
.I /etc/srcpd.conf
.\"
.\"
.SH "SIEHE AUCH"
.BR srcpd\ (8)

